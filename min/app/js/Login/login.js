!function(e){var o,t,r,s=3,a={_storage:{main:"main",fbInfo:"fbInfo",userData:"userData",loginTimes:"loginTimes",fbLoginTimes:"fbLoginTimes",binding:"binding"},_templateSet:{},_wcfget:function(e){var o=e.url,t=JSON.stringify(JSON.stringify(e.para));c.ajax({contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",url:o,data:t,success:function(o){e.success&&e.success(o)},error:function(o){e.error&&e.error(o)},complete:function(o){e.finish&&e.finish(o)},beforeSend:function(o){e.progress&&e.progress(o)}})},_dataStorage:function(e,o){return void 0===o?JSON.parse(localStorage.getItem(e)):null===o?(localStorage.removeItem(e),!0):(localStorage.setItem(e,JSON.stringify(o)),!0)},_dataCookies:function(e,o){return void 0===o?void 0!==Cookies.get(e)&&JSON.parse(Cookies.get(e)):null===o?(Cookies.remove(e),!0):"object"==typeof o?(Cookies.set(e,JSON.stringify(o)),!0):"string"==typeof o&&(Cookies.set(e,o),!0)},template:function(e){if(e in a._templateSet)return a._templateSet[e];var o=c("#"+e).length?c("#"+e).html():"",t=Template7.compile(o);return a._templateSet[e]=t,a._templateSet[e]},jsonUrlDecode:function(e){for(var o in e)"object"==typeof e[o]?this.jsonUrlDecode(e[o]):e[o]=decodeURIComponent(e[o])},jsonUrlEncode:function(e){for(var o in e)"object"==typeof e[o]?this.jsonUrlEncode(e[o]):e[o]=encodeURIComponent(e[o])},_fbLogin:function(){if(null===a._dataStorage(a._storage.fbLoginTimes))n.modal({title:stringObj.text.welcomeTitle,text:stringObj.text.fbLoginContext,buttons:[{text:stringObj.text.cancel},{text:stringObj.text.login,onClick:function(){r="0",fbEvent="login";a._dataCookies(a._storage.main);redirect_uri="http://"+stringObj.WEB_URL,e.location="https://www.facebook.com/v2.8/dialog/oauth?client_id=875839542533172&display=popup&response_type=token&redirect_uri="+redirect_uri+"&auth_type=rerequest&scope=publish_actions"}}]});else{r="0",fbEvent="login";a._dataCookies(a._storage.main);redirect_uri="http://"+stringObj.WEB_URL,e.location="https://www.facebook.com/v2.8/dialog/oauth?client_id=875839542533172&display=popup&response_type=token&redirect_uri="+redirect_uri+"&auth_type=rerequest&scope=publish_actions"}},loginInit:function(o){a._dataStorage(a._storage.loginTimes);$(".aboutLink").click(function(){n.popup(".popup-about")}),$(".privacyLink").click(function(){n.popup(".popup-privacy")}),$(".backBtn").click(function(){var o=$(this).data("src");""!=o?e.location.href=o:e.history.back(-2)}),$(".now_registered").click(function(){l.router.load({url:"regiest/"+Cookies.get("parameter")})}),Cookies.get("app_version")?($(".showpwd").on("touchstart",function(e){$(".password").prop("type","text")}),$(".showpwd").on("touchend",function(e){$(".password").prop("type","password")})):($(".showpwd").mousedown(function(e){$(".password").prop("type","text")}),$(".showpwd").mouseup(function(e){$(".password").prop("type","password")}),$(".showpwd").mouseleave(function(e){$(".password").prop("type","password")})),Cookies.get("app_version")&&($(".fb_login").removeClass("external"),$(".fb_login").prop("href","javascript:void(0)")),$(".fb_login").unbind("click"),$(".fb_login").click(function(){Cookies.set("action","login"),Cookies.set("account","facebook"),Cookies.get("app_version")&&webview.fbLogin()}),$(".google_login").click(function(){Cookies.set("action","login"),Cookies.set("account","google"),a.getThirdPartyUrl("login","google")}),$(".wechat_login").click(function(){e.location="test"}),$(".forget_password").click(function(){l.router.load({url:"forgetpwd/"+Cookies.get("parameter")})}),$(".login-btn").click(function(){""===$(".account").val()||""===$(".password").val()?n.alert(stringObj.text.no_input_name_or_pass,stringObj.text.warn):(n.showPreloader(stringObj.text.logining),$(".login-form").submit())})},queryiscarpolicy:function(e,o){var t={queryiscarpolicyresult:{message_no:"000000000",content01:"",content02:"",content03:"",upr_language_fit:"zh-TW",upr_itemname:stringObj.regulations_title,upr_itemalisa:"personaldata_policy",upr_itemcontent:stringObj.regulations_context,upr_mustread_tag:"1",upr_agreetonext_tag:"1"}},r=JSON.parse(JSON.stringify(t.queryiscarpolicyresult));if("000000000"===r.message_no){var s='<div class="popup authorization-popup"><div class="content-block"><div class="title">'+r.upr_itemname+'</div><div class="authorization-content">'+r.upr_itemcontent+'<div class="row btns"><div class="col-100 agree">'+stringObj.text.agree+"</div></div></div></div></div>";n.popup(s),$(".agree").click(function(){switch(n.closeModal(".authorization-popup"),localStorage.setItem("moc_privatedataallow","1"),o){case"registered":$(".iscarpolicy_style").find("input").prop("checked",!0)}})}},regiestInit:function(o){$(".regiest-left").click(function(){e.history.back()}),Cookies.get("app_version")&&($(".fb-regiest").removeClass("external"),$(".fb-regiest").prop("href","javascript:void(0)")),$(".fb-regiest").click(function(){Cookies.set("action","regiest"),Cookies.set("account","facebook"),Cookies.get("app_version")&&webview.fbLogin()}),$(".google-regiest").click(function(){Cookies.set("action","regiest"),Cookies.set("account","google"),a.getThirdPartyUrl("regiest","google")}),$(".wechat-regiest").click(function(){Cookies.set("action","regiest"),Cookies.set("account","wechat"),a.getThirdPartyUrl("regiest","wechat")})},regiestiscarInit:function(o){n.picker({input:".countrycode-picker",rotateEffect:!1,toolbarTemplate:'<div class="toolbar"><div class="toolbar-inner"><div class="left"><a href="#" class="link close-picker"><i class="fa fa-trash-o" aria-hidden="true"></i></a></div><div class="right"><a href="#" class="link close-picker"><i class="fa fa-check" aria-hidden="true"></i></a></div></div></div>',formatValue:function(e,o,t){return t[0]},onOpen:function(e){$(".left").click(function(){$(".countrycode-picker").val(""),$(".countrycode").val(""),e.value=""})},cols:[{values:[0,1],displayValues:["台灣","大陸"],textAlign:"center",width:"100%",onChange:function(e,o){$(".countrycode").val(e.cols[0].activeIndex+1)}}],onClose:function(e){}});c(".account-block").on("click",function(){n.alert('<input class="input-value" type="text" placeholder="'+stringObj.text.input_email+'">',stringObj.text.email),$(".input-value").val($(".regiestiscar-form .account").val()),$(".input-value").focus(),$(".modal-button").click(function(){var e=$(".input-value").val();$(".regiestiscar-form .account").val(e.toLowerCase())})}),c(".password-block").on("click",function(){n.alert('<input class="input-value" type="password" placeholder="'+stringObj.text.inputPassword+'">',stringObj.text.member_password),$(".input-value").val($(".regiestiscar-form .password").val()),$(".input-value").focus(),$(".modal-button").click(function(){$(".regiestiscar-form .password").val($(".input-value").val())})}),c(".passwordconfirm-block").on("click",function(){n.alert('<input class="input-value" type="password" placeholder="'+stringObj.text.inputPassword+'">',stringObj.text.pass_check),$(".input-value").val($(".regiestiscar-form .passwordconfirm").val()),$(".input-value").focus(),$(".modal-button").click(function(){$(".regiestiscar-form .passwordconfirm").val($(".input-value").val())})}),c(".nickname-block").on("click",function(){n.alert('<input class="input-value" type="text" placeholder="'+stringObj.text.input_nickname+'" onkeydown="input_limit(this, 50);" onkeyup="input_limit(this, 50);">',stringObj.text.nickname),$(".input-value").val($(".regiestiscar-form .nickname").val()),$(".input-value").focus(),$(".modal-button").click(function(){$(".regiestiscar-form .nickname").val($(".input-value").val())})}),c(".cellphone-block").on("click",function(){if(""!=$(".regiestiscar-form .countrycode").val()){switch(n.alert('<input class="input-value" type="number" placeholder="'+stringObj.text.input_cellphone+'">',stringObj.text.mobile),$(".input-value").val($(".regiestiscar-form .cellphone").val()),$(".input-value").focus(),$(".regiestiscar-form .countrycode").val()){case"1":$(".input-value").attr("onkeydown","input_limit(this, 9);");break;case"2":$(".input-value").attr("onkeydown","input_limit(this, 10);")}$(".modal-button").click(function(){$(".regiestiscar-form .cellphone").val($(".input-value").val())})}}),$(".query_iscarpolicy").click(function(){a.queryiscarpolicy("personaldata_policy","registered")}),$(".regiestiscar-left").click(function(){e.history.back()}),$(".registered").click(function(){$(".account-block").removeClass("lengthError"),$(".nickname-block").removeClass("lengthError"),$(".cellphone-block").removeClass("lengthError"),$(".account-block").removeClass("formatError"),$(".account-block").removeClass("spacesError"),$(".password-block").removeClass("spacesError"),$(".passwordconfirm-block").removeClass("spacesError"),$(".nickname-block").removeClass("spacesError"),$(".countrycode-block").removeClass("spacesError"),$(".cellphone-block").removeClass("spacesError"),$(".account-block").removeClass("nullError"),$(".password-block").removeClass("nullError"),$(".passwordconfirm-block").removeClass("nullError"),$(".nickname-block").removeClass("nullError"),$(".countrycode-block").removeClass("nullError"),$(".cellphone-block").removeClass("nullError"),$(".iscarpolicy_style").removeClass("nullError");var e=$(".regiestiscar-form .account").val(),o=$(".regiestiscar-form .password").val(),t=$(".regiestiscar-form .passwordconfirm").val(),r=$(".regiestiscar-form .nickname").val(),s=$(".regiestiscar-form .countrycode").val(),i=$(".regiestiscar-form .cellphone").val(),a=!1;switch(-1==e.search(/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i)&&""!==e&&($(".account-block").addClass("formatError"),a=!0),e.length>64&&($(".account-block").addClass("lengthError"),a=!0),r.length>50&&($(".nickname-block").addClass("lengthError"),a=!0),s){case"1":10!=i.length&&($(".cellphone-block").addClass("lengthError"),a=!0);break;case"2":11!=i.length&&($(".cellphone-block").addClass("lengthError"),a=!0)}if(-1!==e.indexOf(" ")&&($(".account-block").addClass("spacesError"),a=!0),-1!==o.indexOf(" ")&&($(".password-block").addClass("spacesError"),a=!0),-1!==t.indexOf(" ")&&($(".passwordconfirm-block").addClass("spacesError"),a=!0),-1!==r.indexOf(" ")&&($(".nickname-block").addClass("spacesError"),a=!0),-1!==s.indexOf(" ")&&($(".countrycode-block").addClass("spacesError"),a=!0),-1!==i.indexOf(" ")&&($(".cellphone-block").addClass("spacesError"),a=!0),""===e&&($(".account-block").addClass("nullError"),a=!0),""===o&&($(".password-block").addClass("nullError"),a=!0),""===t&&($(".passwordconfirm-block").addClass("nullError"),a=!0),""===r&&($(".nickname-block").addClass("nullError"),a=!0),""===s&&($(".countrycode-block").addClass("nullError"),a=!0),""===i&&($(".cellphone-block").addClass("nullError"),a=!0),$(".iscarpolicy_style").find("input").prop("checked")||($(".iscarpolicy_style").addClass("nullError"),a=!0),""!=o&&""!=t)if(o===t){null==o.match(/((?=.*\d)(?=.*[a-z]).{8})/)?(n.alert("密碼強度不足，需包含英文字母、數字、大於八位數。",stringObj.text.warn),a=!0):a||(Cookies.set("countrycode",s),Cookies.set("cellphone",i),$(".regiestiscar-form").submit())}else n.alert(stringObj.text.pass_check_error,stringObj.text.warn)})},regiestthirdpartyInit:function(o){o.query;var t=JSON.parse(Cookies.get("fb_data"));$(".account").val(t.email),$(".nickname").val(t.name.replace("+"," "));n.picker({input:".regiestthirdparty-content .countrycode-picker",rotateEffect:!1,toolbarTemplate:'<div class="toolbar"><div class="toolbar-inner"><div class="left"><a href="#" class="link close-picker"><i class="fa fa-trash-o" aria-hidden="true"></i></a></div><div class="right"><a href="#" class="link close-picker"><i class="fa fa-check" aria-hidden="true"></i></a></div></div></div>',formatValue:function(e,o,t){return t[0]},onOpen:function(e){$(".left").click(function(){$(".regiestthirdparty-content .countrycode-picker").val(""),$(".regiestthirdparty-content .countrycode").val(""),e.value=""})},cols:[{values:[0,1],displayValues:["台灣","大陸"],textAlign:"center",width:"100%",onChange:function(e,o){$(".regiestthirdparty-content .countrycode").val(e.cols[0].activeIndex+1)}}],onClose:function(e){}});c(".account-block").on("click",function(){n.alert('<input class="input-value" type="text" placeholder="'+stringObj.text.input_email+'">',stringObj.text.email),$(".input-value").val($(".regiestthirdparty-form .account").val()),$(".input-value").focus(),$(".modal-button").click(function(){var e=$(".input-value").val();$(".regiestthirdparty-form .account").val(e.toLowerCase())})}),c(".nickname-block").on("click",function(){n.alert('<input class="input-value" type="text" placeholder="'+stringObj.text.input_nickname+'" onkeydown="input_limit(this, 50);" onkeyup="input_limit(this, 50);">',stringObj.text.nickname),$(".input-value").val($(".regiestthirdparty-form .nickname").val()),$(".input-value").focus(),$(".modal-button").click(function(){$(".regiestthirdparty-form .nickname").val($(".input-value").val())})}),c(".cellphone-block").on("click",function(){if(""!=$(".regiestthirdparty-form .countrycode").val()){switch(n.alert('<input class="input-value" type="number" placeholder="'+stringObj.text.input_cellphone+'">',stringObj.text.mobile),$(".input-value").val($(".regiestthirdparty-form .cellphone").val()),$(".input-value").focus(),$(".regiestiscar-form .countrycode").val()){case"1":$(".input-value").attr("onkeydown","input_limit(this, 9);");break;case"2":$(".input-value").attr("onkeydown","input_limit(this, 10);")}$(".modal-button").click(function(){$(".regiestthirdparty-form .cellphone").val($(".input-value").val())})}}),$(".query_iscarpolicy").click(function(){a.queryiscarpolicy("personaldata_policy","registered")}),$(".regiestthirdparty-left").click(function(){e.history.go(-2)}),$(".registered").click(function(){$(".account-block").removeClass("lengthError"),$(".nickname-block").removeClass("lengthError"),$(".cellphone-block").removeClass("lengthError"),$(".account-block").removeClass("formatError"),$(".account-block").removeClass("spacesError"),$(".nickname-block").removeClass("spacesError"),$(".countrycode-block").removeClass("spacesError"),$(".cellphone-block").removeClass("spacesError"),$(".account-block").removeClass("nullError"),$(".nickname-block").removeClass("nullError"),$(".countrycode-block").removeClass("nullError"),$(".cellphone-block").removeClass("nullError"),$(".iscarpolicy_style").removeClass("nullError");var e=$(".regiestthirdparty-form .account").val(),o=$(".regiestthirdparty-form .nickname").val(),r=$(".regiestthirdparty-form .countrycode").val(),s=$(".regiestthirdparty-form .cellphone").val();$(".regiestthirdparty-form .ssodata").val(JSON.stringify(t));var i=!1;switch(-1==e.search(/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i)&&""!==e&&($(".account-block").addClass("formatError"),i=!0),e.length>64&&($(".account-block").addClass("lengthError"),i=!0),o.length>50&&($(".nickname-block").addClass("lengthError"),i=!0),r){case"1":10!=s.length&&($(".cellphone-block").addClass("lengthError"),i=!0);break;case"2":11!=s.length&&($(".cellphone-block").addClass("lengthError"),i=!0)}-1!==e.indexOf(" ")&&($(".account-block").addClass("spacesError"),i=!0),-1!==r.indexOf(" ")&&($(".countrycode-block").addClass("spacesError"),i=!0),-1!==s.indexOf(" ")&&($(".cellphone-block").addClass("spacesError"),i=!0),""!==e&&""!==e.trim()||($(".account-block").addClass("nullError"),i=!0),""!==o&&""!==o.trim()||($(".nickname-block").addClass("nullError"),i=!0),""===r&&($(".countrycode-block").addClass("nullError"),i=!0),""!==s&&""!==s.trim()||($(".cellphone-block").addClass("nullError"),i=!0),$(".iscarpolicy_style").find("input").prop("checked")||($(".iscarpolicy_style").addClass("nullError"),i=!0),i||(Cookies.set("countrycode",r),Cookies.set("cellphone",s),$(".regiestthirdparty-form").submit())})},resendVerifyCode:function(){n.showIndicator(),$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},contentType:"application/json; charset=utf-8",url:"/resendVerifyCode/verify",type:"POST",data:JSON.stringify({countrycode:Cookies.get("countrycode"),cellphone:Cookies.get("cellphone")}),dataType:"json",success:function(e){if(n.hideIndicator(),"0000"===e.code){var o=new Date;o.setMinutes(o.getMinutes()+10),Cookies.set("shortly",o),$(".shortly").countdown("option",{until:o}),$(".not-send").css("display","block"),$(".re-send").css("display","none")}else n.alert(e.message,stringObj.text.warn)},error:function(e){n.hideIndicator(),noNetwork()}})},regiestverifyInit:function(o){$(".regiestverify-left").click(function(){e.history.back()}),$(".confirm").click(function(){$(".verifycode-block").removeClass("lengthError"),$(".verifycode-block").removeClass("spacesError"),$(".verifycode-block").removeClass("nullError");var e=$(".verify-form .verifycode").val(),o=!1;6!=e.length&&($(".verifycode-block").addClass("lengthError"),o=!0),-1!==e.indexOf(" ")&&($(".verifycode-block").addClass("spacesError"),o=!0),""===e&&($(".verifycode-block").addClass("nullError"),o=!0),o||$(".verify-form").submit()});var t=new Date,r=new Date;$(".not-send").css("display","block"),r.setMinutes(r.getMinutes()+10),Cookies.set("shortly",r),(t-r)/864e5<0?$(".not-send").css("display","block"):$(".re-send").css("display","block"),$(".re-send").click(function(){a.resendVerifyCode()}),$(".shortly").countdown({until:r,onExpiry:liftOff,onTick:watchCountdown,format:"MS"})},forgetpwdInit:function(o){$(".forgetpwd-left").click(function(){e.history.back()}),$(".send").click(function(){n.showIndicator(),$(".account-block").removeClass("lengthError"),$(".account-block").removeClass("formatError"),$(".account-block").removeClass("spacesError"),$(".account-block").removeClass("nullError");var e=$(".forgetpwd-form .account").val(),o=!1;-1==e.search(/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i)&&""!==e&&($(".account-block").addClass("formatError"),o=!0),e.length>64&&($(".account-block").addClass("lengthError"),o=!0),-1!==e.indexOf(" ")&&($(".account-block").addClass("spacesError"),o=!0),""===e&&($(".account-block").addClass("nullError"),o=!0),o?n.hideIndicator():$(".forgetpwd-form").submit()})},regiestsuccessInit:function(t){var r=t.query;Cookies.remove("countrycode"),Cookies.remove("cellphone"),$(".regiestsuccess-left").click(function(){e.history.back()}),showTime(r.redirect_uri),$(".goto").click(function(){clearTimeout(o),s=3,e.location=r.redirect_uri})},forgetpwdsuccessInit:function(t){var r=t.query;$(".forgetpwdsuccess-left").click(function(){e.history.back()}),showTime(r.redirect_uri),$(".goto").click(function(){clearTimeout(o),s=3,e.location=r.redirect_uri})},resetpwdsuccessInit:function(t){var r=t.query;$(".resetpwdsuccess-left").click(function(){e.history.back()}),showTime(r.redirect_uri),$(".goto").click(function(){clearTimeout(o),s=3,toWeb(r.redirect_uri)})},resetpwdInit:function(o){$(".resetpwd-left").click(function(){e.history.back()}),$(".send").click(function(){$(".verifycode-block").removeClass("lengthError"),$(".verifycode-block").removeClass("spacesError"),$(".password-block").removeClass("spacesError"),$(".passwordconfirm-block").removeClass("spacesError"),$(".verifycode-block").removeClass("nullError"),$(".password-block").removeClass("nullError"),$(".passwordconfirm-block").removeClass("nullError");var e=$(".verifycode").val(),o=$(".password").val(),t=$(".passwordconfirm").val(),r=!1;if(6!=e.length&&($(".verifycode-block").addClass("lengthError"),r=!0),-1!==e.indexOf(" ")&&($(".verifycode-block").addClass("spacesError"),r=!0),-1!==o.indexOf(" ")&&($(".password-block").addClass("spacesError"),r=!0),-1!==t.indexOf(" ")&&($(".passwordconfirm-block").addClass("spacesError"),r=!0),""===e&&($(".verifycode-block").addClass("nullError"),r=!0),""===o&&($(".password-block").addClass("nullError"),r=!0),""===t&&($(".passwordconfirm-block").addClass("nullError"),r=!0),""!=o&&""!=t)if(o===t){null==o.match(/((?=.*\d)(?=.*[a-z]).{8})/)?(n.alert("密碼強度不足，需包含英文字母、數字、大於八位數。",stringObj.text.warn),r=!0):r||$(".resetpwd-form").submit()}else n.alert(stringObj.text.pass_check_error,stringObj.text.warn)})},loginsuccessInit:function(o){var t=o.query;$(".loginsuccess-left").click(function(){e.history.back()}),showTime(t.redirect_uri+"?sat="+t.sat),$(".goto").click(function(){e.location=t.redirect_uri+"?sat="+t.sat})},changepwdInit:function(o){o.query;$(".changepwd-left").click(function(){e.history.back()}),$(".send").click(function(){$(".passwordold-block").removeClass("spacesError"),$(".passwordnew-block").removeClass("spacesError"),$(".passwordnewconfirm-block").removeClass("spacesError"),$(".passwordold-block").removeClass("nullError"),$(".passwordnew-block").removeClass("nullError"),$(".passwordnewconfirm-block").removeClass("nullError");var e=$(".passwordold").val(),o=$(".passwordnew").val(),t=$(".passwordnewconfirm").val(),r=!1;if(-1!==e.indexOf(" ")&&($(".passwordold-block").addClass("spacesError"),r=!0),-1!==o.indexOf(" ")&&($(".passwordnew-block").addClass("spacesError"),r=!0),-1!==t.indexOf(" ")&&($(".passwordnewconfirm-block").addClass("spacesError"),r=!0),""===e&&($(".passwordold-block").addClass("nullError"),r=!0),""===o&&($(".passwordnew-block").addClass("nullError"),r=!0),""===t&&($(".passwordnewconfirm-block").addClass("nullError"),r=!0),""!=o&&""!=t)if(o===t){null==o.match(/((?=.*\d)(?=.*[a-z]).{8})/)?(n.alert("密碼強度不足，需包含英文字母、數字、大於八位數。",stringObj.text.warn),r=!0):r||$(".changepwd-form").submit()}else n.alert(stringObj.text.pass_check_error,stringObj.text.warn)})},changepwdsuccessInit:function(o){var t=o.query;$(".changepwdsuccess-left").click(function(){e.history.back()}),showTime(t.redirect_uri),$(".goto").click(function(){e.location=t.redirect_uri})},getThirdPartyUrl:function(o,t){$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},contentType:"application/json; charset=utf-8",url:"/"+o+"/geturl/"+t+"/"+Cookies.get("parameter"),type:"POST",data:"",success:function(o){e.location=o},error:function(e){noNetwork()}})},loginThirdParty:function(e,o,t){"login"===Cookies.get("action")?n.showPreloader(stringObj.text.logining):"regiest"===Cookies.get("action")&&n.showPreloader(stringObj.text.processing),$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},contentType:"application/json; charset=utf-8",url:"/"+e+"/callback/"+o+"/"+Cookies.get("parameter"),type:"POST",data:'{"access_token":"'+t+'"}',dataType:"json",success:function(e){n.hidePreloader(),"login"===Cookies.get("action")?"1000"===e.code?l.router.load({url:"thirdpartyloginsuccess?redirect_uri="+e.redirect_uri+"&sat="+e.sat+"&mur="+e.mur}):(stringObj.return_header(e.code),_tip&&(n.alert(_tip+"( "+e.code+" )",stringObj.text.warn),_tip=null,$(".modal-button").click(function(){l.router.load({url:"login/"+Cookies.get("parameter")})}))):"regiest"===Cookies.get("action")&&("2000"===e.code?(e.ssodata.access_token=t,e.ssodata.sso_photourl="http://graph.facebook.com/"+e.ssodata.id+"/picture?type=large",Cookies.set("fb_data",JSON.stringify(e.ssodata)),l.router.load({url:"regiestthirdparty/"+Cookies.get("parameter")})):(stringObj.return_header(e.code),_tip&&(n.alert(_tip+"( "+e.code+" )",stringObj.text.warn),_tip=null,$(".modal-button").click(function(){l.router.load({url:"login/"+Cookies.get("parameter")})}))))},error:function(e){n.hidePreloader(),noNetwork()}})}},n=new Framework7({swipeBackPage:!1,pushState:!0,pushStateNoAnimation:!0,swipePanel:"left",swipePanelActiveArea:-1,imagesLazyLoadPlaceholder:"app/image/imgDefault.png",imagesLazyLoadThreshold:150,animatePages:!1,materialRipple:!1,modalButtonOk:stringObj.text.confirm,modalButtonCancel:stringObj.text.cancel}),c=Dom7,l=n.addView(".view-main",{dynamicNavbar:!0}),u=(new Swiper(".explanation-block",{pagination:".swiper-pagination",paginationClickable:!0,centeredSlides:!0,autoplay:3500,autoplayDisableOnInteraction:!1,loop:!0,effect:"fade"}),n.toast("message",'<i class="fa fa-exclamation-triangle"></i>',{}));noNetwork=function(){u.show(stringObj.text.noNetwork),$(".toast-container").css("color","#F26531"),$(".toast-container").css("top","50%"),$(".toast-container").css("left","45%"),$(".toast-container").css("width","40%"),$(".toast-container").css("background-color","rgba(30,30,30,.85)")},unregistered=function(){n.modal({title:stringObj.text.warn,text:"此帳號尚未註冊",buttons:[{text:stringObj.text.cancel,onClick:function(){}},{text:stringObj.text.now_registered,onClick:function(){a.queryiscarpolicy("personaldata_policy","fb_registered")}}]})},input_limit=function(e,o){var t=o;e.value.length>t&&(e.value=e.value.substr(0,t))},showTime=function(t){s-=1,$(".show-time span").html(s),o=setTimeout("showTime('"+t+"')",1e3),0==s&&(s=3,clearTimeout(o),e.location=t)},liftOff=function(){$(".re-send").css("display","block"),$(".not-send").css("display","none")},watchCountdown=function(e){e[5]<10&&(e[5]="0"+e[5]),e[6]<10&&(e[6]="0"+e[6]),$(".not-send").text(e[5]+":"+e[6]+" 後可重新發送")},goTo=function(e){l.router.load({url:e+"/"+Cookies.get("parameter")})},toWeb=function(o){isMobile.Android()?Android.toWeb(o):isMobile.iOS()?iPhone.toWeb(o):e.location=o},getCookie=function(e){var o=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return null!=o?unescape(o[2]):null},c(document).on("open",".modal",function(e){$(".view").css("-webkit-filter","blur(5px)")}),c(document).on("close",".modal",function(e){$(".view").css("-webkit-filter","blur(0px)")}),$(document).ready(function(){var o,t,r=e.location.href,s=[];if(-1!=r.indexOf("access_token")){for(o=r.split("?")[1].split("&"),i=0;i<o.length;i++)t=o[i].split("="),s.push(t[1]);switch(Cookies.get("account")){case"facebook":a.loginThirdParty(Cookies.get("action"),Cookies.get("account"),s[0])}}else l.router.load({url:"login/"+Cookies.get("parameter")})}),loginThirdParty=function(e){a.loginThirdParty(Cookies.get("action"),Cookies.get("account"),e)},c(document).on("pageInit",function(o){n.hidePreloader(),void 0!=$(".error").val()&&n.alert($(".error").val(),stringObj.text.warn);var r=o.detail.page;switch(t=r.name,r.name){case"login":case"login_b":a.loginInit(r);break;case"regiest":a.regiestInit(r);break;case"regiestiscar":a.regiestiscarInit(r);break;case"regiestthirdparty":a.regiestthirdpartyInit(r);break;case"regiestverify":a.regiestverifyInit(r);break;case"forgetpwd":a.forgetpwdInit(r);break;case"regiestsuccess":a.regiestsuccessInit(r);break;case"forgetpwdsuccess":a.forgetpwdsuccessInit(r);break;case"resetpwdsuccess":a.resetpwdsuccessInit(r);break;case"resetpwd":a.resetpwdInit(r);break;case"loginsuccess":case"thirdpartyloginsuccess":a.loginsuccessInit(r);break;case"changepwdsuccess":a.changepwdsuccessInit(r);break;case"logout":void 0!=$(".logout_error").val()&&n.alert($(".logout_error").val(),stringObj.text.warn),$(".modal-button").click(function(){e.history.back()})}})}(window);